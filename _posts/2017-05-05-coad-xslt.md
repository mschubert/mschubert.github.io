---
layout: post
title: Shipping dates from TCGA barcodes
---

https://portal.gdc.cancer.gov
"Data" > "Biospecimen Supplement"

The files basically look like this:

{% highlight xml %}
<?xml version="1.0" encoding="UTF-8"?>
<bio:tcga_bcr ...>
  <bio:patient>
    <bio:samples>
      <bio:sample>
        <bio:portions>
          <bio:portion>
            <bio:analytes>
              <bio:analyte>
                <bio:aliquots>
                  <bio:aliquot>
                    <bio:bcr_aliquot_barcode>TCGA-x</bio:bcr_aliquot_barcode>
                    <bio:bcr_year_of_shipment>2011<bio:year_of_shipment>
                  </bio:aliquot>
                </bio:aliquots>
              </bio:analyte>
            </bio:analytes>
          </bio:portion>
        </bio:portions>
      </bio:sample>
    </bio:samples>
  </bio:patient>
</bio:tcga_bcr>
{% endhighlight xml %}

The important bit here is to list all the name spaces we are using using `xmlns:`.

{% highlight xslt %}
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:bio="http://tcga.nci/bcr/xml/biospecimen/2.7"
    xmlns:admin="http://tcga.nci/bcr/xml/administration/2.7">
<xsl:output method="text" indent="no"/>
<xsl:strip-space elements="*"/>

<xsl:template match="/">

  <xsl:for-each select="bio:tcga_bcr/bio:patient/bio:samples/bio:sample">
  <xsl:for-each select="bio:portions/bio:portion">
  <xsl:for-each select="bio:analytes/bio:analyte">
  <xsl:for-each select="bio:aliquots/bio:aliquot">

    <xsl:value-of select="bio:bcr_aliquot_barcode"/>
    <xsl:text>&#x9;</xsl:text>
    <xsl:value-of select="bio:year_of_shipment"/>
    <xsl:text>-</xsl:text>
    <xsl:value-of select="bio:month_of_shipment"/>
    <xsl:text>&#xa;</xsl:text>

  </xsl:for-each>
  </xsl:for-each>
  </xsl:for-each>
  </xsl:for-each>

</xsl:template>
</xsl:stylesheet>
{% endhighlight xslt %}

{% highlight sh %}
tar -xf gdc_download_20170505.tar.gz
find gdc_download_20170505 -name "\*.xml" -exec xsltproc my.xslt {} \;
{% endhighlight sh %}
